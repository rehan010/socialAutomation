{%extends 'registration/base.html'%}
{%load static%}


{% block content %}
<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
</head>
<style>
  figure {

    text-align: left;
  }
  figcaption {
    font-size: 14px;
    color: gray;
    margin-top: 5px;
    padding-left: 20px;
  }
  .carousel-container {
      height: 400px; /* Set the desired height for the carousel container */
  }







</style>
<!-- This is an example component -->
<form method="post">
    {% csrf_token %}
    <div class="editor mx-auto  flex flex-col text-gray-800 border border-gray-300 p-4 shadow-lg max-w-3xl">
        <div class="bg-white overflow-hidden align-center shadow-none">
            <div class="  pl-4">
                <header class="border-b border-grey-400">
                    <a href="#"
                       class="block cursor-pointer py-4 flex items-center text-sm outline-none focus:outline-none focus:border-gray-300 transition duration-150 ease-in-out">
                        <img src="https://images.pexels.com/photos/614810/pexels-photo-614810.jpeg?auto=compress&cs=tinysrgb&h=750&w=1260"
                             class="h-9 w-9 rounded-full object-cover"
                             alt="user"/>
                        <p class="block ml-2 font-bold">{{posted_on}}</p>
                    </a>
                    <!--                <span class="block ml-4 text-xs text-gray-600">5 minutes ago</span>-->

                </header>
            </div>
            <div class="grid grid-cols-2 min-w-full">
                <div>
                    <figure>
                        <figcaption>{{post.post}}</figcaption>
                    </figure>
                </div>
                <br>
                <div class="col-span-2 w-full">
                    <div id="carouselExampleIndicators" class="carousel slide " data-interval="false">
                        <ol class="carousel-indicators">
                            {% for image in post.images.all %}
                            <li data-target="#carouselExampleIndicators" data-slide-to="{{ forloop.counter0 }}"
                                {% if forloop.first %}class="active" {% endif %}></li>
                            {% endfor %}
                        </ol>
                        <div class="carousel-inner ">
                            <!-- Loop through the images and create carousel items -->
                            {% for image in post.images.all %}
                            {% if image.is_mp4_file %}
                            <div class="carousel-item {% if forloop.first %}active{% endif %}">
                                <video playsinline="playsinline" width="1400"  height="400"
                                       muted="muted" loop="loop"  class="video h-74" controls>
                                    <source src="{{ image.image.url }}" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                            </div>
                            {% else %}
                            <div class="carousel-item {% if forloop.first %}active{% endif %}">
                                <img src="{{ image.image.url }}" class="image h-74 w-100" alt="Image">
                            </div>
                            {% endif %}
                            {% endfor %}
                        </div>
                        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button"
                           data-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button"
                           data-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
                <div class="col-span-2 w-full">
                    <div class="  pl-4">
                        <div class="pt-4">
                            <div class="mb-2">
                                <div class="flex items-center">
                            <span class="mr-3 inline-flex items-center cursor-pointer">
                                <svg class="fill-heart text-gray-700 inline-block h-7 w-7 heart"
                                     xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                     stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                                </svg>
                            </span>
                                    <span class="mr-3 inline-flex items-center cursor-pointer">
                                <svg class="text-gray-700 inline-block h-7 w-7 " xmlns="http://www.w3.org/2000/svg"
                                     fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                                </svg>
                            </span>
                                </div>
                                <span class="text-gray-600 text-sm font-bold">{{no_likes}} Likes</span>
                                <br>
                                {% if post.comment_check %}
                                <span class="text-gray-600 text-sm font-bold">{{no_comments}} Comments</span>
                                {% else %}
                                <span class="text-gray-600 text-sm font-bold">0 Comments</span>
                                {% endif %}
                            </div>
                        </div>
                        {% if post.comment_check %}
                        {% for d in data %}
                        <input type="hidden" name="comment_urn" value="{{ d.comment_urn }}">
                        <div class="p-4 border border-gray-300 rounded-lg mb-4 bg-gray-100">
                            <div class="flex items-start mb-2">
                                <img class="h-12 w-12 rounded-full object-cover"
                                     {% if d.profile_image %}
                                     src="{{d.profile_image}}"
                                     {% else %}
                                     src="https://images.pexels.com/photos/1450082/pexels-photo-1450082.jpeg?auto=compress&cs=tinysrgb&dpr=3&h=750&w=1260"
                                     {% endif %}
                                     alt="{{ d.name }}" />
                                <div class="ml-2">
                                    <p class="font-bold">{{ d.name }}:</p>
                                    <p class="text-gray-700">{{ d.text }}</p>
                                    {% if d.urls %}
                                        <div class="mt-2">
                                            {% for img in d.urls %}
                                                <img src="{{ img }}" alt="Image">
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>

                            {% if d.replies %}
                                <div class="pl-8">
                                    {% for reply in d.replies %}
                                        <div class="flex items-start mb-2">
                                            <img class="h-10 w-10 rounded-full object-cover"
                                                 {% if reply.profile_image %}
                                                 src="{{ reply.profile_image }}"
                                                 {% else %}
                                                 src="https://images.pexels.com/photos/1450082/pexels-photo-1450082.jpeg?auto=compress&cs=tinysrgb&dpr=3&h=750&w=1260"
                                                 {% endif %}
                                                 alt="{{ reply.name }}" />
                                            <div class="ml-2">
                                                <p class="font-bold">{{ reply.name }}:</p>
                                                <p class="text-gray-700">{{ reply.text }}</p>
                                                {% if reply.urls %}
                                                    <div class="mt-2">
                                                        {% for url in reply.urls %}
                                                            <img src="{{ url }}" alt="Image">
                                                        {% endfor %}
                                                    </div>
                                                {% endif %}
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            <div class="mt-2">
                                <div class="flex items-start">
                                    <textarea class="w-full resize-none outline-none appearance-none"
                                              aria-label="Agrega un comentario..."
                                              placeholder="Write a reply"
                                              autocomplete="off" autocorrect="off"
                                              style="height: 36px;width: 300px;"
                                              name="reply"></textarea>
                                    <button class="ml-2 px-2 py-1 text-gray-600 border rounded-lg focus:outline-none">
                                        Post Reply
                                    </button>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                        <div class="mt-2">
                            <div class="flex items-start">
                                    <textarea class="w-full resize-none outline-none appearance-none"
                                              aria-label="Agrega un comentario..." placeholder="write a comment"
                                              autocomplete="off" autocorrect="off" style="height: 36px;width: 300px;"
                                              name="comment"></textarea>
                                <button class="ml-2 px-2 py-1 bg-blue-500 text-white rounded-lg focus:outline-none">
                                    Post Comment
                                </button>
                            </div>
                        </div>
                        {% else %}
                        <p>Comments are disabled for this post.</p>
                        {% endif %}
                    </div>
<!--                <div class="pt-4 pb-12 pr-3">-->
<!--                    <div class="flex items-start">-->
<!--                        <form method="post" enctype="multipart/form-data" action="{% url 'comment_post'%}">-->
<!--                            {% csrf_token %}-->
<!--                            <textarea class="w-full resize-none outline-none appearance-none"-->
<!--                                  aria-label="Agrega un comentario..." placeholder="write a comment" autocomplete="off"-->
<!--                                  autocorrect="off" style="height: 36px;width: 300px;" name="comment"></textarea>-->
<!--                            <input type="text" value="{{ids}}" name="id" style="display:none;">-->
<!--                            <input type="text" value="{{page_id}}" name="page_id" style="display:none;">-->
<!--                            <input type="text" value="{{post_id}}" name="post_id" style="display:none;">-->
<!--                            <input type="text" value="{{provider_name}}" name="provider_name" style="display:none;">-->
<!--                            <button class="mb-2 focus:outline-none border-none bg-transparent text-blue-600">post</button>-->
<!--                        </form>-->
<!--                        -->
<!--                    </div>-->
<!--                </div>-->
                </div>
            </div>
        </div>
    </div>
</form>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<script>
    // Manually initialize the carousel
    const myCarousel = new bootstrap.Carousel(document.getElementById('carouselExampleIndicators'), {
        interval: false, // Set to false to disable autoplay
        pause: 'hover',  // Pause on hover (optional, if desired)
    });

    // Play video when the carousel slide is shown
    myCarousel._element.addEventListener('slide.bs.carousel', (event) => {
        const activeSlide = event.relatedTarget;
        const videoElement = activeSlide.querySelector('video');
        if (videoElement) {
            videoElement.play();
        }
    });
</script>
{%endblock%}